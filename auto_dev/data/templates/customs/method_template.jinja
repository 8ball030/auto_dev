    def {{ method_name }}(self, _message: ApiHttpMessage{% for param in path_params_snake_case %}, {{ param }}{% endfor %}{% if method|lower in ['post', 'put', 'patch', 'delete'] %}, body{% endif %}):
        {% raw %}"""{% endraw %}Handle {{ method|upper }} request for {{ path }}.{% raw %}"""{% endraw %}
{%- if path_params_snake_case %}
        self.context.logger.debug(f"Path parameters: {% for param in path_params_snake_case %}{{ param }}={{ '{' }}{{ param }}{{ '}' }}{% if not loop.last %}, {% endif %}{% endfor %}")
{%- endif %}
{%- if method|lower in ['post', 'put', 'patch', 'delete'] %}
        self.context.logger.debug(f"Request body: {body}")
{% endif %}
        try:
            {%- if method|lower == 'get' and not path_params %}
            result = {{ schema|lower|replace(' ', '_') }}_dao.get_all()
            {%- elif method|lower == 'post' and operation_type == 'insert' %}
            {{ schema|lower|replace(' ', '_') }}_body = json.loads(body)
            result = {{ schema|lower|replace(' ', '_') }}_dao.insert({{ schema|lower|replace(' ', '_') }}_body)
            {%- elif method|lower == 'post' and operation_type == 'update' %}
            {{ schema|lower|replace(' ', '_') }}_body = json.loads(body)
            result = {{ schema|lower|replace(' ', '_') }}_dao.update({{ schema|lower|replace(' ', '_') }}_body)
            {%- else %}
            # TODO: Implement {{ method|upper }} logic for {{ path }}
            raise NotImplementedError
            {%- endif %}

            self.context.logger.info("Successfully processed {{ method|upper }} request for {{ path }}")
            self.context.logger.debug(f"Result: {result}")
            return result
        except Exception as e:
            self.context.logger.exception("Error processing {{ method|upper }} request for {{ path }}")
            self.context.logger.exception(f"Error: {e!s}")
            raise
