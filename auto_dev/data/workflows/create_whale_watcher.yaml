id: '1'
name: create_new_agent_from_fsm_with_ledger
description: A workflow to create a new agent from a finite state machine using a ledger connection.
kwargs:
  new_author: author_2
  new_agent: agent_2
  new_skill: simple_fsm_2
  connection_hash: bafybeigntoericenpzvwejqfuc3kqzo2pscs76qoygg5dbj6f4zxusru5e
  contract_hash: bafybeigovz3fg5g46f5geyy33fpvuof3ewktslxswipk37fqpmfj42uysi
  web3_address: https://mainnet.base.org
  chain_name: base
  fsm_spec_path: whale_watcher.yaml
tasks:

  - id: '0'
    name: Verify packages
    description: Check that the packages registry is up to date.
    command: autonomy packages init
    continue_on_error: true

  - id: '1'
    name: create_new_agent
    description: Use Adev to make a new agent.
    command: adev create ${kwargs.new_author}/${kwargs.new_agent} -t eightballer/base --no-publish --no-clean-up --force

  - id: '2'
    name: Eject Metrics Skill
    description: Ejct the metrics skill from the agent to be used in the FSM.
    command: adev eject skill eightballer/metrics ${kwargs.new_author}/${kwargs.new_skill}
    working_dir: ${kwargs.new_agent}
  
  # - id: '3'
  #   name: Add FSM to Agent
  #   description: Add fsm to the agent.
  #   command: adev augment skill-from-fsm ../${kwargs.fsm_spec_path} ${kwargs.new_author}/${kwargs.new_skill}
  #   working_dir: ${kwargs.new_agent}

  # - id: '4'
  #   name: Add connection to Agent
  #   description: Add Ledger connection to the agent.
  #   command: aea -s add connection ${kwargs.connection_hash}
  #   working_dir: ${kwargs.new_agent}

  # - id: '5'
  #   name: Add contract to Agent
  #   description: Add contract to the agent.
  #   command: aea -s add contract ${kwargs.contract_hash}
  #   working_dir: ${kwargs.new_agent}

  
  # - id: '6'
  #   name: Add ledger config to Agent
  #   description: Add ledger config to the agent.
  #   command: aea -s config set vendor.valory.connections.ledger.config.ledger_apis.${kwargs.chain_name}.address ${kwargs.web3_address}
  #   working_dir: ${kwargs.new_agent}
  

  # - id: '7'
  #   name: Publish Agent
  #   description: Publish the agent to the registry.
  #   command: adev publish ${kwargs.new_author}/${kwargs.new_agent}
  #   working_dir: ${kwargs.new_agent}

  # - id: '8'
  #   name: Run the agent
  #   description: Run the agent.
  #   command: adev run dev ${kwargs.new_author}/${kwargs.new_agent} --force


